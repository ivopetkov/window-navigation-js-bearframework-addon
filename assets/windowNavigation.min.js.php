<?php

/*
 * Window navigation JS package for Bear Framework
 * https://github.com/ivopetkov/window-navigation-js-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.windowNavigation=ivoPetkov.bearFrameworkAddons.windowNavigation||function(){var n=[],o=async function(){for(var o of n)await o()},t=0,e=function(){t++;var n=(new Date).getTime().toString()+"-"+t;return r("ipwni",n),n},i=function(n){var o=window.history.state;return null!==o&&"object"==typeof o&&void 0!==o[n]?o[n]:null},r=function(n,o){var t=window.history.state;if(null===t&&(t={}),"object"!=typeof t)throw new Error("The history.state is not an object!");t[n]=o,window.history.replaceState(t,null,window.location)},a=!1;window.addEventListener("popstate",async()=>{a||await o()});var l=function(){return window.location.pathname},w=function(){var n=window.location.search;return""!==n?n.substring(1):""},u=function(n){null===n&&(n=""),window.history.replaceState(window.history.state,null,window.location.origin+window.location.pathname+(n.length>0?"?"+n:"")+window.location.hash)},d=function(n,o){for(var t=n.toLowerCase(),e=w().split("&"),i=[],r=!1,a=0;a<e.length;a++){var l=e[a],d=l.split("=");decodeURIComponent(d[0].toLowerCase())===t?(null!==o&&i.push(encodeURIComponent(n)+"="+encodeURIComponent(o)),r=!0):i.push(l)}r||i.push(encodeURIComponent(n)+"="+encodeURIComponent(o)),u(i.join("&"))},c=function(){var n=window.location.hash;return""!==n?n.substring(1):""},s=function(n,o){var t=i("ipwnd");null===t&&(t={}),t[n]=o,r("ipwnd",t)};return{addChangeHandler:function(o){n.push(o)},removeChangeHandler:function(o){n=n.filter((function(n){return n!=o}))},getID:function(){var n=i("ipwni");return null===n?e():n},getPath:l,setPath:function(n){null===n&&(n=""),window.history.replaceState(window.history.state,null,window.location.origin+n+window.location.search+window.location.hash)},getQuery:w,setQuery:u,getQueryParameter:function(n){for(var o=n.toLowerCase(),t=w().split("&"),e=0;e<t.length;e++){var i=t[e].split("=");if(decodeURIComponent(i[0].toLowerCase())===o)return decodeURIComponent(i[1])}return null},setQueryParameter:d,deleteQueryParameter:function(n){d(n,null)},makeQuery:function(n){var o=[];for(var t of n)o.push(encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return o.join("&")},getHash:c,setHash:function(n){null===n&&(n=""),window.history.replaceState(window.history.state,null,window.location.origin+window.location.pathname+window.location.search+(n.length>0?"#"+n:""))},getData:function(n){var o=i("ipwnd");return null!==o&&void 0!==o[n]?o[n]:null},setData:s,goBack:function(){return new Promise((function(n,o){var t=function(){n()};window.addEventListener("popstate",(function(){window.removeEventListener("popstate",t),t()})),window.history.back()}))},open:async function(n,t,r,u,d){var v=!1,f=!1;null==n?n=l():v=n!==l(),null==t?t=w():v=t!==w(),null==r&&(r=c()),null==u?u={}:f=JSON.stringify(u)!==JSON.stringify(function(){var n=i("ipwnd");return null!==n?n:{}}()),void 0===d&&(d=null);var h=window.location.origin+n+(t.length>0?"?"+t:"")+(r.length>0?"#"+r:"");if(window.location.toString()===h&&(null===d||!1===d)&&!f)return!1;if(v&&!1!==d||!0===d)a=!0,window.location.assign(h),v||window.location.reload();else{for(var p in window.history.pushState(null,"",h),u)s(p,u[p]);e(),await o()}},reload:function(){window.location.reload()}}}();
EOT;
